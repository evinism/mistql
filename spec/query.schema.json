{
  "oneOf": [
    {
      "type": "object",
      "properties": {
        "select": {
          "$ref": "#/definitions/expression"
        },
        "where": {
          "$ref": "#/definitions/expression"
        }
      },
      "required": [
        "select"
      ],
      "additionalProperties": false
    }
  ],
  "definitions": {
    "expression": {
      "oneOf": [
        {
          "type": [
            "string",
            "number",
            "boolean",
            "null"
          ]
        },
        {
          "type": "array",
          "items": {
            "$ref": "#/definitions/expression"
          }
        },
        {
          "type": "object",
          "properties": {
            "timestamp": {
              "oneOf": [
                {
                  "const": "now"
                },
                {
                  "type": "string",
                  "format": "date-time"
                }
              ]
            }
          },
          "required": [
            "timestamp"
          ]
        },
        {
          "type": "object",
          "properties": {
            "duration": {
              "type": "string",
              "format": "duration"
            }
          },
          "required": [
            "duration"
          ]
        },
        {
          "type": "object",
          "properties": {
            "parameter": {
              "type": "string"
            }
          },
          "required": [
            "parameter"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "variable": {
              "type": "string"
            }
          },
          "required": [
            "variable"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "$comment": "n-ary operations",
          "properties": {
            "operator": {
              "enum": [
                "+",
                "*",
                "&&",
                "||"
              ]
            },
            "arguments": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/expression"
              }
            }
          },
          "required": [
            "operator",
            "arguments"
          ],
          "additionalProperties": false
        },
        {
          "type": "object",
          "$comment": "binary operations",
          "properties": {
            "operator": {
              "enum": [
                "-",
                "/",
                ">",
                ">=",
                "<",
                "<="
              ]
            },
            "arguments": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/expression"
              },
              "minItems": 2,
              "maxItems": 2
            }
          },
          "required": [
            "operator",
            "arguments"
          ],
          "additionalProperties": false
        }
      ]
    }
  }
}